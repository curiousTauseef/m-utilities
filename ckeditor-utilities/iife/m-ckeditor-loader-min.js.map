{"version":3,"sources":["../_m-ckeditor-loader.js","m-ckeditor-loader.js"],"names":["window","mUtilities","ckeditor","script_data","document","currentScript","dataset","editor_list","querySelectorAll","cke_url","cke","upl_url","ckeUpl","img_viewer","ckeImgViewer","length","ckeditor_instances","std_toolbar","lite_toolbar","xlite_toolbar","script","createElement","onload","forEach","item","idx","options","uploaderUrl","uploadMaxSize","imgViewer","toolbar","ckeUplMaxSize","classList","contains","removePlugins","ClassicEditor","create","then","editor","disabled","isReadOnly","id","el","closest","remove","catch","error","console","group","log","groupEnd","src","type","head","appendChild","m_cke_loader"],"mappings":"0BAMe,gBAGmB,IAAtBA,OAAOC,aACfD,OAAOC,WAAa,SAEmB,IAA/BD,OAAOC,WAAWC,WAC1BF,OAAOC,WAAWC,SAAW,IAG/B,MAAMC,EAAcC,SAASC,cAAcC,QACzCC,EAAcH,SAASI,iBAAiB,mBAO1C,GALAR,OAAOC,WAAWC,SAASO,QAAUT,OAAOC,WAAWC,SAASO,SAAYN,EAAYO,KAAO,0CAC/FV,OAAOC,WAAWC,SAASS,QAAUX,OAAOC,WAAWC,SAASS,SAAYR,EAAYS,QAAU,0BAClGZ,OAAOC,WAAWC,SAASW,WAAab,OAAOC,WAAWC,SAASW,YAAeV,EAAYW,cAAgB,WAG1GP,EAAYQ,OAAQ,CAMtBf,OAAOgB,mBAAqB,GAE5B,MAAMC,EAAc,CAChB,UACA,IACA,OACA,SACA,OACA,IACA,iBAAkB,mBAAoB,kBAAmB,oBACzD,IACA,UAAW,SACX,IACA,eACA,eACA,IACA,cACA,aACA,cACA,OACA,QAGFC,EAAe,CACb,UACA,IACA,OACA,SACA,OACA,IACA,iBAAkB,mBAAoB,kBAAmB,oBACzD,IACA,UAAW,SACX,IACA,eACA,eACA,IAEA,aACA,cACA,OACA,QAGFC,EAAgB,CACd,UACA,IACA,OACA,SACA,OACA,IACA,iBAAkB,mBAAoB,kBAAmB,oBACzD,IACA,UAAW,SACX,IACA,eACA,eACA,IAEA,aAEA,OACA,QAGJ,IAAIC,EAAShB,SAASiB,cAAc,UACpCD,EAAOE,OAAU,KAEff,EAAYgB,SAAQ,SAAUC,EAAMC,GAElC,IAAIC,EAAU,CACZC,YAAa3B,OAAOC,WAAWC,SAASS,QACxCiB,cAAgB,QAChBC,UAAW7B,OAAOC,WAAWC,SAASW,WACtCiB,QAASb,GAIRO,EAAKlB,QAAQyB,gBACdL,EAAQE,cAAgBJ,EAAKlB,QAAQyB,eAInCP,EAAKQ,UAAUC,SAAS,eAC1BP,EAAU,CACRI,QAASZ,EACTgB,cAAe,CAAE,iBAAkB,gBAE7BV,EAAKQ,UAAUC,SAAS,kBAChCP,EAAU,CACRI,QAASX,EACTe,cAAe,CAAE,iBAAkB,cAAe,iBAItDC,cAAcC,OAAOZ,EAAME,GAcxBW,KAAMC,IACFd,EAAKe,WACND,EAAOE,YAAa,GAEtBxC,OAAOgB,mBAAmBQ,EAAKiB,GAAKjB,EAAKiB,GAAKhB,GAAOa,EAGrDlC,SAASI,iBAAiB,mCAAmCe,QAASmB,IACpEA,EAAGH,UAAW,EACdG,EAAGC,QAAQ,eAAeX,UAAUY,OAAO,gBAG9CC,MAAOC,IAENC,QAAQC,MAAM,YAAcvB,GAC5BsB,QAAQD,MAAMA,GACdC,QAAQE,IAAI,WAAazB,GACzBuB,QAAQG,iBAQhB9B,EAAO+B,IAAMnD,OAAOC,WAAWC,SAASO,QACxCW,EAAOgC,KAAO,kBACdhD,SAASiD,KAAKC,YAAYlC,ICrK9BmC","sourcesContent":["/* globals ClassicEditor */\n\n/*\n  FILE DA INCLUDERE per l'utilizzo di ckeditor\n*/\n\nexport default function () {\n  'use strict';\n\n  if(typeof window.mUtilities === 'undefined') {\n    window.mUtilities = {};\n  }\n  if(typeof window.mUtilities.ckeditor === 'undefined') {\n    window.mUtilities.ckeditor = {};\n  }\n\n  const script_data = document.currentScript.dataset,\n    editor_list = document.querySelectorAll('textarea.editor');\n\n  window.mUtilities.ckeditor.cke_url = window.mUtilities.ckeditor.cke_url || (script_data.cke || '/assets/ckeditor-dist/m-ckeditor-min.js');\n  window.mUtilities.ckeditor.upl_url = window.mUtilities.ckeditor.upl_url || (script_data.ckeUpl || '/ckeditor/file-uploader');\n  window.mUtilities.ckeditor.img_viewer = window.mUtilities.ckeditor.img_viewer || (script_data.ckeImgViewer || '/viewer/');  // (NB: con slash finale)\n\n\n  if (editor_list.length) {\n\n    // Istanza ckeditor.\n    // L'istanza Ã¨ raggiungibile tramite il suo id (se esiste)\n    // o, in sua mancanza, tramite l'indice dell'elemento\n    // es: ckeditor_instances.__textarea_id__\n    window.ckeditor_instances = {};\n\n    const std_toolbar = [\n        'heading',\n        '|',\n        'bold',\n        'italic',\n        'link',\n        '|',\n        'alignment:left', 'alignment:center', 'alignment:right', 'alignment:justify',\n        '|',\n        'outdent', 'indent',\n        '|',\n        'bulletedList',\n        'numberedList',\n        '|',\n        'imageUpload',\n        'blockQuote',\n        'insertTable',\n        'undo',\n        'redo'\n      ],\n\n      lite_toolbar = [\n        'heading',\n        '|',\n        'bold',\n        'italic',\n        'link',\n        '|',\n        'alignment:left', 'alignment:center', 'alignment:right', 'alignment:justify',\n        '|',\n        'outdent', 'indent',\n        '|',\n        'bulletedList',\n        'numberedList',\n        '|',\n        //'imageUpload',\n        'blockQuote',\n        'insertTable',\n        'undo',\n        'redo'\n      ],\n\n      xlite_toolbar = [\n        'heading',\n        '|',\n        'bold',\n        'italic',\n        'link',\n        '|',\n        'alignment:left', 'alignment:center', 'alignment:right', 'alignment:justify',\n        '|',\n        'outdent', 'indent',\n        '|',\n        'bulletedList',\n        'numberedList',\n        '|',\n        //'imageUpload',\n        'blockQuote',\n        //'insertTable',\n        'undo',\n        'redo'\n      ];\n\n    let script = document.createElement('script');\n    script.onload =  () => {\n\n      editor_list.forEach(function (item, idx) {\n\n        let options = {\n          uploaderUrl: window.mUtilities.ckeditor.upl_url,\n          uploadMaxSize : 4 * 1024 * 1024,\n          imgViewer: window.mUtilities.ckeditor.img_viewer,\n          toolbar: std_toolbar\n        };\n\n        // max size da attributo data\n        if(item.dataset.ckeUplMaxSize) { // in bytes\n          options.uploadMaxSize = item.dataset.ckeUplMaxSize;\n        }\n\n        // https://ckeditor.com/docs/ckeditor5/latest/builds/guides/integration/configuration.html#removing-features\n        if (item.classList.contains('editor-lite')) {\n          options = {\n            toolbar: lite_toolbar,\n            removePlugins: [ 'mUploadAdapter', 'ImageUpload' ],\n          };\n        } else if(item.classList.contains('editor-xlite')) {\n          options = {\n            toolbar: xlite_toolbar,\n            removePlugins: [ 'mUploadAdapter', 'ImageUpload', 'insertTable' ],\n          };\n        }\n\n        ClassicEditor.create(item, options)\n\n\n        // .then( editor => {\n        //   /* eslint-disable */\n        //   console.groupCollapsed();\n        //   console.log('textarea',  item );\n        //   console.log('editor',  editor );\n        //   console.log('toolbar elements',Array.from( editor.ui.componentFactory.names() ));\n        //   console.log('plugins', ClassicEditor.build.plugins.map( plugin => plugin.pluginName ));\n        //   console.groupEnd();\n        //   /* eslint-enable */\n        // })\n\n          .then( editor => {\n            if(item.disabled) {\n              editor.isReadOnly = true;\n            }\n            window.ckeditor_instances[item.id ? item.id : idx] = editor;\n\n            // abilita eventuali elementi disabilitati con attributo `data-enable=\"editor\"`\n            document.querySelectorAll('[data-enable=\"editor\"]:disabled').forEach( el => {\n              el.disabled = false;\n              el.closest('.form-group').classList.remove('disabled');\n            });\n          })\n          .catch( error => {\n            /* eslint-disable */\n            console.group('textarea ' + idx);\n            console.error(error);\n            console.log('textarea',  item );\n            console.groupEnd();\n            /* eslint-enable */\n          });\n\n      }); // end forEach\n\n    }; // end onload\n\n    script.src = window.mUtilities.ckeditor.cke_url;\n    script.type = 'text/javascript';\n    document.head.appendChild(script);\n\n  } // end if( editor_list.length\n\n}\n","import m_cke_loader from '../_m-ckeditor-loader';\nm_cke_loader();\n"]}